<!DOCTYPE html>
<html th:replace="~{layout/layout_main :: layout(~{::title}, ~{::link}, ~{::style}, ~{::script}, ~{::div.container})}"
      lang="ko"
      xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<title>회원정보 수정</title>

<link rel="stylesheet" href="">

<style>
  :root{
    --bg:#f6f1ea;
    --panel:#ffffff;
    --line:#eadfd3;
    --line-2:#d8c6b3;
    --text:#2a2320;
    --muted:#7a6a61;
    --brand:#8b6a52;
    --accent:#cda57a;
    --danger:#c94b4b;
    --shadow:0 18px 45px rgba(54,38,25,.10);
    --radius:18px;
  }
  *{ box-sizing:border-box; }
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", sans-serif;
    background: radial-gradient(1200px 600px at 20% 10%, #fff, transparent 55%),
                radial-gradient(900px 500px at 80% 90%, #fff, transparent 50%),
                var(--bg);
    color:var(--text);
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px 14px;
  }
  .wrap{ width: 520px; max-width: 100%; }
  .brandbar{ display:flex; justify-content:center; margin-bottom:14px; letter-spacing:.14em; font-weight:800; color:var(--brand); }
  .card{ background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; }
  .header{ padding:20px 18px 12px; text-align:center; border-bottom:1px solid var(--line); background: linear-gradient(180deg, #fff, #fff7ef); }
  .header h1{ margin:0; font-size:20px; letter-spacing:.04em; }
  .header p{ margin:6px 0 0; color:var(--muted); font-size:13px; }

  .body{ padding:18px; }
  .hint{
    font-size:12.5px;
    color:var(--muted);
    line-height:1.55;
    background:#fffaf5;
    border:1px solid var(--line);
    border-radius:12px;
    padding:10px;
    margin-bottom:12px;
  }
  .grid2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
  .field{ margin-bottom:12px; }
  .label{ display:flex; align-items:center; justify-content:space-between; margin-bottom:6px; font-size:13px; color:var(--muted); font-weight:700; }
  .input{
    width:100%;
    padding:12px 12px;
    border:1px solid var(--line-2);
    border-radius:12px;
    outline:none;
    background:#fff;
    font-size:14px;
    transition:border-color .15s, box-shadow .15s;
  }
  .input:focus{ border-color:var(--accent); box-shadow:0 0 0 4px rgba(205,165,122,.22); }

  .btnrow{ display:flex; gap:10px; margin-top:14px; }
  .btn{
    flex:1;
    border:0;
    border-radius:14px;
    padding:12px 14px;
    font-weight:900;
    cursor:pointer;
    letter-spacing:.04em;
  }
  .btn-main{ background: linear-gradient(180deg, var(--brand), #6f513f); color:#fff; }
  .btn-sub{ background:#fff; color:var(--brand); border:1px solid var(--line-2); }

  .error{
    display:none;
    margin-top:10px;
    font-size:12.5px;
    color:#fff;
    background:var(--danger);
    border-radius:12px;
    padding:10px 10px;
    line-height:1.45;
  }
  .error.show{ display:block; }

  .links{ margin-top:12px; display:flex; justify-content:center; gap:12px; flex-wrap:wrap; color:var(--muted); font-size:12.5px; }
  .links a{ color:var(--muted); text-decoration:none; border-bottom:1px dashed transparent; }
  .links a:hover{ color:var(--brand); border-bottom-color: rgba(139,106,82,.5); }

  @media (max-width:560px){
    .grid2{ grid-template-columns:1fr; }
  }
</style>

<script th:inline="javascript">
/*<![CDATA[*/
document.addEventListener('DOMContentLoaded', () => {

  const frm = document.getElementById('profileFrm');
  const err = document.getElementById('err');

  function show(msg){
    err.textContent = msg;
    err.classList.add('show');
  }

  function submitForm(){
    err.classList.remove('show');

    const mobile = frm.mobile.value.trim();
    const postcode = frm.postcode.value.trim();
    const address = frm.address.value.trim();
    const detail = frm.detail_address.value.trim();

    // 최소 검증(원하면 더 빡세게)
    if(mobile && mobile.replaceAll('-', '').length < 10){
      return show("휴대폰번호를 다시 확인하세요.");
    }
    if(postcode && postcode.length < 5){
      return show("우편번호를 다시 확인하세요.");
    }
    if(address && address.length < 2){
      return show("주소를 다시 확인하세요.");
    }
    if(detail && detail.length < 1){
      return show("상세주소를 입력하세요.");
    }

    frm.action = /*[[@{/security/member/profileEdit}]]*/ 'url';
    frm.method = "post";
    frm.submit();
  }

  document.getElementById('btnSave').addEventListener('click', submitForm);
  document.getElementById('btnCancel').addEventListener('click', () => history.back());
});
/*]]>*/
</script>

<body>
<div class="container"
     th:with="
       m = (${memberDto} != null ? ${memberDto} : ${session.sessionMemberDTO}),
       name = (${m} != null and ${m.name} != null ? ${m.name} : '홍길동'),
       memberid = (${m} != null and ${m.memberid} != null ? ${m.memberid} : 'hong123'),
       email = (${m} != null and ${m.email} != null ? ${m.email} : 'hong@test.com'),
       mobile = (${m} != null and ${m.mobile} != null ? ${m.mobile} : '01012345678'),
       postcode = (${m} != null and ${m.postcode} != null ? ${m.postcode} : '06236'),
       address = (${m} != null and ${m.address} != null ? ${m.address} : '서울특별시 강남구 테헤란로'),
       detail = (${m} != null and ${m.detail_address} != null ? ${m.detail_address} : '101동 1001호'),
       extra = (${m} != null and ${m.extra_address} != null ? ${m.extra_address} : '(참고) OO빌딩')
     ">

  <div class="wrap">
    <div class="brandbar">CIEL</div>

    <section class="card" aria-label="회원정보 수정 카드">
      <div class="header">
        <h1>회원정보 수정</h1>
        <p>연락처/주소 정보를 변경합니다.</p>
      </div>

      <div class="body">
        <div class="hint">
          아이디/이메일은 정책상 수정 불가로 두고, 연락처/주소만 수정합니다.
        </div>

        <form id="profileFrm" name="profileFrm">
          <div class="grid2">
            <div class="field">
              <div class="label"><span>이름</span></div>
              <input class="input" type="text" th:value="${name}" readonly />
            </div>
            <div class="field">
              <div class="label"><span>아이디</span></div>
              <input class="input" type="text" th:value="${memberid}" readonly />
            </div>
          </div>

          <div class="grid2">
            <div class="field">
              <div class="label"><span>이메일</span></div>
              <input class="input" type="text" th:value="${email}" readonly />
            </div>
            <div class="field">
              <div class="label"><span>휴대폰번호</span></div>
              <input class="input" type="text" name="mobile" id="mobile" th:value="${mobile}" placeholder="01012345678" />
            </div>
          </div>

          <div class="grid2">
            <div class="field">
              <div class="label"><span>우편번호</span></div>
              <input class="input" type="text" name="postcode" id="postcode" th:value="${postcode}" placeholder="우편번호" />
            </div>
            <div class="field">
              <div class="label"><span>주소</span></div>
              <input class="input" type="text" name="address" id="address" th:value="${address}" placeholder="주소" />
            </div>
          </div>

          <div class="grid2">
            <div class="field">
              <div class="label"><span>상세주소</span></div>
              <input class="input" type="text" name="detail_address" id="detail_address" th:value="${detail}" placeholder="상세주소" />
            </div>
            <div class="field">
              <div class="label"><span>참고항목</span></div>
              <input class="input" type="text" name="extra_address" id="extra_address" th:value="${extra}" placeholder="참고항목" />
            </div>
          </div>

          <div class="error" id="err"></div>

          <div class="btnrow">
            <button class="btn btn-main" type="button" id="btnSave">저장</button>
            <button class="btn btn-sub" type="button" id="btnCancel">취소</button>
          </div>

          <div class="links">
            <a th:href="@{/security/member/mypage}">마이페이지</a>
            <span>|</span>
            <a th:href="@{/security/passwdChange}">비밀번호 변경</a>
            <span>|</span>
            <a th:href="@{/index}">메인</a>
          </div>
        </form>
      </div>
    </section>
  </div>
</div>
</body>
</html>
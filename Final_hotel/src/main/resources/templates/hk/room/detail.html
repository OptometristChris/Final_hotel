<!DOCTYPE html>
<html lang="ko" 
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{js/layout/layout_main :: layout(~{::title}, ~{::link}, ~{::style}, ~{::script}, ~{::content})}">
<head>
<meta charset="UTF-8">
<title>객실 상세</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

<style>
.container {
    max-width: 1100px;
    margin: 80px auto;
}

/* ===== 캐러셀 이미지 박스 ===== */
.carousel-img-box {
    width: 100%;
    height: 500px;              /* 높이 고정 */
    background: #f3f1ed;        /* 호텔 느낌 배경 */
    display: flex;
    align-items: center;
    justify-content: center;
}

.carousel-img-box img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;        /* 잘리지 않게 */
}

/* 텍스트 영역 */
.room-name {
    font-size: 34px;
    font-weight: 600;
    text-align: center;     /* ⭐ 가운데 정렬 */
    margin-bottom: 40px;
    letter-spacing: -0.5px;
}

.info {
    margin-top: 10px;
    font-size: 18px;
}

.price {
    font-size: 24px;
    font-weight: bold;
    margin-top: 80px;
    text-align: center;
}

/* ===== 스펙 가로 정렬 영역 ===== */

.room-spec-wrap {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 60px 0 40px;
    text-align: center;
}

.room-spec {
    flex: 1;
}


.spec-title {
    font-size: 14px;
    color: #888;
    margin-bottom: 6px;
}

.spec-value {
    font-size: 16px;
    font-weight: 600;
}

.divider {
    width: 1px;
    height: 60px;
    background: #ddd;
}

/* ================= 어메니티 ================= */

.amenity-section {
    margin-top: 100px;
    padding: 60px 0;
    border-top: 1px solid #eee;
}

.amenity-title {
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 50px;
}

.amenity-category {
    margin-bottom: 40px;
}

.category-name {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 25px;
}

.amenity-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 25px 40px;
}

.amenity-item {
    font-size: 15px;
    color: #444;
    position: relative;
    padding-left: 20px;
}

.amenity-item::before {
    content: "•";
    position: absolute;
    left: 0;
    color: #999;
}

a {
    color: #666;
    text-decoration: none;
    font-size: 14px;
}

a:hover {
    color: #000;
}

div[style="margin-top:30px;"] {
    text-align: center;
}


/* ================= 다른객실추천 ================= */
.recommend-section {
    margin-top: 120px;
}

.recommend-grid {
    display: flex;
    gap: 30px;
}

.recommend-card {
    flex: 1;
    padding: 20px;
    border: 1px solid #eee;
    text-align: center;
    transition: 0.2s;
}

.recommend-card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.rec-name {
    font-size: 18px;
    margin-bottom: 10px;
}

.rec-price {
    font-size: 16px;
    color: #666;
}
</style>
</head>

<body>
<div th:fragment="content" style="margin-top:140px;">

<div class="container">

	<div class="room-name" th:text="${room.room_name}"></div>

	<div id="roomCarousel" class="carousel slide" data-ride="carousel">

    <div class="carousel-inner">

        <div class="carousel-item"
             th:each="img, stat : ${imageList}"
             th:classappend="${stat.index == 0} ? ' active'">

            <div class="carousel-img-box">
                <img th:src="@{${img}}">
            </div>

        </div>

    </div>

    <a class="carousel-control-prev"
       href="#roomCarousel"
       role="button"
       data-slide="prev">
        <span class="carousel-control-prev-icon"></span>
    </a>

    <a class="carousel-control-next"
       href="#roomCarousel"
       role="button"
       data-slide="next">
        <span class="carousel-control-next-icon"></span>
    </a>

</div>
	
    <div class="room-spec-wrap">

    <div class="room-spec">
        <div class="spec-title">침대 타입</div>
        <div class="spec-value" th:text="${room.bed_type}"></div>
    </div>

    <div class="divider"></div>

    <div class="room-spec">
        <div class="spec-title">전망</div>
        <div class="spec-value" th:text="${room.view_type}"></div>
    </div>

    <div class="divider"></div>

    <div class="room-spec">
        <div class="spec-title">투숙 인원</div>
        <div class="spec-value">
            <span th:text="${room.max_capacity}"></span>명
        </div>
    </div>

    <div class="divider"></div>

    <div class="room-spec">
        <div class="spec-title">객실 면적</div>
        <div class="spec-value">
            <span th:text="${room.room_size}"></span>㎡
        </div>
    </div>

	</div>

   <div class="price">
	    <span class="detail-price"
	          th:attr="data-base-price=${room.base_price}">
	        ₩ <span th:text="${room.base_price}"></span>
	    </span>
	</div>
	
	<!-- ================= 어메니티 ================= -->
	<div class="amenity-section">

    <h2 class="amenity-title">어메니티</h2>

    <!-- 일반 -->
    <div class="amenity-category">
        <div class="category-name">일반</div>

        <div class="amenity-grid">
            <div class="amenity-item">손전등</div>
            <div class="amenity-item">슬리퍼</div>
            <div class="amenity-item">전화기</div>
            <div class="amenity-item">티포트</div>
            <div class="amenity-item">금고</div>
            <div class="amenity-item">구두주걱</div>
            <div class="amenity-item">구두 클리너</div>
            <div class="amenity-item">미니바</div>
            <div class="amenity-item">55" UHD TV</div>
        </div>
    </div>

    <hr>

    <!-- 욕실 -->
    <div class="amenity-category">
        <div class="category-name">욕실</div>

        <div class="amenity-grid">
            <div class="amenity-item">목욕 가운</div>
            <div class="amenity-item">비데</div>
            <div class="amenity-item">헤어드라이어</div>
            <div class="amenity-item">욕실 용품</div>
        </div>
    </div>

    <hr>

    <!-- 기타 -->
    <div class="amenity-category">
        <div class="category-name">기타</div>

        <div class="amenity-grid">
            <div class="amenity-item">케이블/위성 TV 채널</div>
            <div class="amenity-item">무료 생수 1일 2병</div>
            <div class="amenity-item">보이스 메일 서비스</div>
            <div class="amenity-item">커피 및 티 메이커</div>
        </div>
    </div>

	</div>
	
	<div style="margin-top:30px;">
        <a href="javascript:history.back()">← 목록으로</a>
    </div>
    
    <!-- ================= 추천 객실 ================= -->
	<div class="recommend-section" th:if="${recommendList != null and !#lists.isEmpty(recommendList)}">
	
	    <h2 class="amenity-title">다른 객실 추천</h2>
	
	    <div class="recommend-grid">
	
	        <div class="recommend-card"
	             th:each="rec : ${recommendList}">
	
	            <a th:href="@{/room/detail(room_id=${rec.room_type_id})}">
	                <div class="rec-name"
	                     th:text="${rec.room_name}"></div>
	
	                <div class="rec-price">
	                    ₩ <span th:text="${rec.base_price}"></span>
	                </div>
	            </a>
	
	        </div>
	
	    </div>
	</div>
	
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>


<script>
/* 통화 변경시 환율 적용 */
document.addEventListener("DOMContentLoaded", function(){

    console.log("상세페이지 로드됨");

    let exchangeRates = { KRW: 1 };
    let currentCurrency = localStorage.getItem("currency") || "KRW";

    function convertPrice(price){
        const rate = exchangeRates[currentCurrency] || 1;

        let converted = price;

        if(currentCurrency !== "KRW"){
            converted = price * rate;
        }

        return new Intl.NumberFormat('ko-KR', {
            style: 'currency',
            currency: currentCurrency
        }).format(converted);
    }

    function applyCurrency(){
        const el = document.querySelector(".detail-price");
        if(!el) return;

        const base = Number(el.dataset.basePrice);
        el.innerText = convertPrice(base);
    }

    fetch("https://open.er-api.com/v6/latest/KRW")
        .then(res => res.json())
        .then(data => {
            exchangeRates = data.rates;
            exchangeRates["KRW"] = 1;

            applyCurrency();
        });

});
</script>

</div>
</body>
</html>